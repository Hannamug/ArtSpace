<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="reservation">

	<insert id="insert">
		insert into reservation(reserve_status, estimate, user_id, hall_id, create_date)
						 values('Y', #{estimate}, #{user_id}, #{hall_id}, #{create_date})
 			<selectKey keyProperty="reserve_id" resultType="int" order="AFTER" >
				select LAST_INSERT_ID()
			</selectKey>	
	</insert>
	
	<insert id="insertTime">
		insert into reserve_date(reserve_date, reserve_time, reserve_id)
						 values(#{reserve_date}, #{reserve_time}, #{reserve_id})
	</insert>
	
	<insert id="insertEquip">
		insert into reservation_equipment(equip_type, equip_name, equip_num, equip_price, reserve_id)
						 values(#{equip_type}, #{equip_name}, #{equip_num}, #{equip_price}, #{reserve_id})
	</insert>
	
	<select id="duplicationCheck" resultType="int">
		select count(*) from reserve_date
		where reserve_date = #{reserve_date} and reserve_time = #{reserve_time}
	</select>
	
	<!-- 하루 빌릴려는데 다른 시간대가 있는지 체크 -->
	<select id="dayDuplicationCheck" resultType="int">
		select count(*) from reserve_date
		where reserve_date = #{reserve_date}
	</select>



	

</mapper>